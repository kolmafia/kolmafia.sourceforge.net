<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//Tigris//DTD XHTML 1.0 Transitional//EN"
"http://style.tigris.org/tigris_transitional.dtd">
<html>
<head>
  <style type="text/css">/* <![CDATA[ */  @import "css/tigris.css";  @import "css/inst.css";  /*  ]]> */ </style>
  <link rel="stylesheet" type="text/css" href="css/print.css" media="print" />
<script src="scripts/tigris.js" type="text/javascript">
</script>
 <title>KoLmafia: Source Code Organization and Build System</title>
</head>

<body>
<a href="http://sourceforge.net"><img src="http://sourceforge.net/sflogo.php?group_id=126572&amp;type=1" width="88" height="31" border="0" alt="SourceForge.net Logo" /></a>
 <h2>Source Code Organization and Build System</h2>

<div class="app">

 <h3>Release Information</h3>
 <div class="axial">
 <table>
  <tr>
   <th>Project:</th>
   <td>KoLmafia</td>
  </tr>
 </table>
 </div>

 <h3>Overview</h3>

 <dl>
  <dt>What are the most important facts that a developer should know about this source code organization and build system?</dt>

  <dd>The source code will be organized according to the packages detailed in the table below and will use the directory structure and package naming conventions detailed at the <a href="http://java.sun.com/docs/codeconv/html/CodeConventions.doc8.html">Sun website</a>.  The automated build system is not likely to be used in the development of this system, though at a later stage in the development process, it may become useful to make this feature available.</dd>

  <dt>What are the ranked goals of this source code organization and build system?</dd>

  <dd>
   <ol>
    <li>Division of modules into intuitive subpackages</li>
    <li>Compatibility with standard build processes</li>
    <li>Separation of version-controlled files from files generated by the build process</li>
   </ol>
  </dd>

 </dl>



 <h3>Key Directories and Files in Developer Working Copies</h3>

 <table width="100%">
  <tr><th>Path</th><th>VC</th><th>Description</th></tr>
  <tr>
   <td>build.xml</td>
   <td>Yes</td>
   <td>Build file</td>
  </tr>
  <tr>
   <td>src/net/sourceforge/</td>
   <td>Yes</td>
   <td>Source code</td>
  </tr>
  <tr>
   <td>build/</td>
   <td>No</td>
   <td>Output of build process</td>
  </tr>
  <tr>
   <td>dist/</td>
   <td>No</td>
   <td>Deployable archives of classes generated by build process</td>
  </tr>
 </table>



 <h3>Package Summary</h3>



 <h3>Build Targets</h3>

 <table width="100%">
  <tr><th width="100">Target</th><th>Description</th></tr>

  <tr>
   <td>init</td>
   <td>Creates the directories which are used by the other build targets.  A direct compliment to the clean target, the directories created in this target will be removed through the clean target.</li>
  </tr>

  <tr>
   <td>clean</td>
   <td>Deletes files generated by previous build commands.  Files under version control are not touched, provided the files under version control adhere to Goal #3 indicated above.</li>
  </tr>

  <tr>
   <td>compile</dt>
   <td>Compiles Java source code and creates .class files under the "build" directory.  In addition, because the compiled files may need data files, it also copies the necessary non-source files into the "build" directory.</td>
  </tr>

  <tr>
   <td>recompile</dt>
   <td>Deletes files generated by previous build commands and recompiles the Java source code.  Specifically, it compiles the code in a clean state to detect possible compile errors that may result from the changing of class interfaces.</td>
  </tr>

  <tr>
  <td>createjar = default</td>
  <td>Creates a .jar archive of compiled classes and adds all necessary manifest information to the created .jar archive, including the main-class attribute, which makes the .jar archive executable.</td>
  </tr>

  <tr>
  <td>createtar = default</td>
  <td>Creates a .tar.gz archive of all source code and web documents stored in the current folder.  This is the target that is used to generate the gzipped source during each release.</td>
  </tr>

  <tr>
  <td>rejar</td>
  <td>Deletes files generated by previous build commands and creates a .jar archive of compiled classes and adds all necessary manifest information to the created .jar archive, including the main-class attribute, which makes the .jar archive executable.</td>
  </tr>

  <tr>
  <td>javadoc</td>
  <td>Generates the technical documentation (javadocs) for the system.  Note that the user must be online for this target to succeed, as it links to the <a href="http://java.sun.com/j2se/1.5.0/docs/api/">Java API</a> to create the appropriate hyperlinks to the Sun documentation.</td>
  </tr>

  <tr>
  <td>dist</td>
  <td>Packages the system for distribution/deployment to servers or end users.  Specifically, it creates .jar archive of classes recompiled from a clean state and generates the technical documentation (javadocs)</td>
  </tr>

  <tr>
   <td>cvscheck</dt>
   <td>Gets a fresh checkout of the files currently in the CVS repository and assures that all of the files successfully compile.  This target is to make sure that new files that were intended to be added <i>have</i> been added to the repository and should be used before any release is tagged.</td>
  </tr>

  <tr>
  <td>exec</td>
  <td>Creates a .jar archive of compiled classes and executes the main class of the .jar archive.  The .jar archive is dependent on the most recent compilation; the data will not be recompiled from a clean state.</td>
  </tr>

 </table>

 <h3>Source Code Organization and Build System Checklist</h3>

 <dl>
  <dt>Division of modules into intuitive subpackages</dt>
  <dd>The subpackages are currently under evaluation.  Though this goal has been partially achieved, as the project evolves, special attention must be given to ensure that the subpackages remain intuitive.</dd>

  <dt>Compatibility with standard build processes</dt>
  <dd>Yes; the build process has been tested with Apache Ant 1.6.2, using version 1.5.0 of the Java SDK for Windows XP (J2SE 5.0), with the source JVM being 1.5.  Because Apache Ant and Java are platform-independent, it is assumed that the build processes will succeed on other platforms with at least version 1.5.0 of the Java SDK installed.</dd>

  <dt>Separation of version-controlled files from files generated by the build process</dt>
  <dd>Yes; this occurs through different destination directories for the build process than the ones available through CVS.  As the project evolves, this distinction should be easy to maintain.</dd>

  </dd>

 </dl>

</div>

</body>
</html>
